/*!
 * vue-event-manager v2.1.1
 * https://github.com/pagekit/vue-event-manager
 * Released under the MIT License.
 */

!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.VueEventManager=n()}(this,function(){"use strict";var u=Object.assign||function(r){var t=[],n=arguments.length-1;for(;0<n--;)t[n]=arguments[n+1];return t.forEach(function(n){Object.keys(n||{}).forEach(function(t){return r[t]=n[t]})}),r},s=Array.isArray;function o(t){return null!==t&&"object"==typeof t}function f(t){return void 0===t}function n(n,r){Object.keys(n||{}).forEach(function(t){return r.call(null,n[t],t)})}function c(t){if(null==this)throw new TypeError('"this" is null or not defined');if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=Object(this),r=n.length>>>0,e=arguments[1],i=0;i<r;){var o=n[i];if(t.call(e,o,i,n))return i;i++}return-1}var t=function(){this.log=null,this.listeners={}};t.prototype.on=function(t,n,r){var e=this;void 0===r&&(r=0);var i,o=(void 0===(i=this.listeners[t])&&(i=[]),i.findIndex||(i.findIndex=c),i),u=o.findIndex(function(t){return t.priority<r});return~u?o.splice(u,0,{callback:n,priority:r}):o.push({callback:n,priority:r}),this.listeners[t]=o,function(){return e.off(t,n)}},t.prototype.off=function(t,n){n||delete this.listeners[t];var r=this.listeners[t];if(r&&n){var e=r.findIndex(function(t){return t.callback===n});~e&&r.splice(e,1)}},t.prototype.trigger=function(t,n,i){void 0===n&&(n=[]),void 0===i&&(i=!1);var o=new a(t,n),u=function(t){return Promise.reject(t)},r=function(t){return f(t)?o.result:t};this.log&&this.log.call(this,o);var e=(this.listeners[o.name]||[]).concat().reduce(function(t,n){var r=n.callback,e=function(t){return f(t)||(o.result=t),!1===t&&o.stopPropagation(),o.isPropagationStopped()?o.result:r.apply(r,[o].concat(o.params))};return i?t.then(e,u):e(t)},i?Promise.resolve():void 0);return i?e.then(r,u):r(e)};var a=function(t,n){o(t)||(t={name:t}),s(n)||(n=[n]),u(this,t,{params:n,result:void 0})};a.prototype.stopPropagation=function(){this.stop=!0},a.prototype.isPropagationStopped=function(){return!0===this.stop};var p=new t;function r(t,n){if(!n)return t;if(!t)return n;var r=u({},t);for(var e in n){var i=r[e],o=n[e];i&&!s(i)&&(i=[i]),r[e]=i?i.concat(o):s(o)?o:[o]}return r}function e(){var e=this,i=[],t=this.$options.events;t&&(n(t,function(t,r){n(s(t)?t:[t],function(t){var n=0;o(t)&&(n=t.priority,t=t.handler),i.push(p.on(r,function(t,n){if("string"==typeof t)return function(){return n[t].apply(n,arguments)};return t.bind(n)}(t,e),n))})}),this.$on("hook:beforeDestroy",function(){return i.forEach(function(t){return t()})}))}return p.install=function(t,n){void 0===n&&(n={}),this.installed||(t.prototype.$events=t.events=u(p,n),t.prototype.$trigger=function(t,n,r){return void 0===n&&(n=[]),void 0===r&&(r=!1),o(t)||(t={name:t,origin:this}),p.trigger(t,n,r)},t.config.optionMergeStrategies.events=r,t.mixin({beforeCreate:e}))},"undefined"!=typeof window&&window.Vue&&window.Vue.use(p),p});