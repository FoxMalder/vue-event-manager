/*!
 * vue-event-manager v2.0.0
 * https://github.com/pagekit/vue-event-manager
 * Released under the MIT License.
 */

!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.VueEventManager=n()}(this,function(){"use strict";var e=Array.isArray;function u(t){return void 0===t}function n(n,e){Object.keys(n||{}).forEach(function(t){e.call(null,n[t],t)})}Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=Object(this),e=n.length>>>0,r=arguments[1],i=0;i<e;){var o=n[i];if(t.call(r,o,i,n))return i;i++}return-1}});var t=function(){this.listeners={}};t.prototype.on=function(t,n,e){var r=this;void 0===e&&(e=0);var i=this.listeners[t]||[],o=i.findIndex(function(t){return t.priority<e});return~o?i.splice(o,0,{callback:n,priority:e}):i.push({callback:n,priority:e}),this.listeners[t]=i,function(){return r.off(t,n)}},t.prototype.off=function(t,n){n||delete this.listeners[t];var e=this.listeners[t];if(e&&n){var r=e.findIndex(function(t){return t.callback===n});~r&&e.splice(r,1)}},t.prototype.trigger=function(t,n,i){void 0===i&&(i=!1);var o=new f(t,n),s=function(t){return Promise.reject(t)},e=function(t){return u(t)?o.result:t},r=(this.listeners[t]||[]).concat().reduce(function(t,n){var e=n.callback,r=function(t){return u(t)||(o.result=t),!1===t&&o.stopPropagation(),o.isPropagationStopped()?o.result:e.apply(e,[o].concat(o.params))};return i?t.then(r,s):r(t)},i?Promise.resolve():void 0);return i?r.then(e,s):e(r)};var f=function(t,n){void 0===n&&(n=[]),e(n)||(n=[n]),this.name=t,this.params=n,this.result=void 0};f.prototype.stopPropagation=function(){this.stop=!0},f.prototype.isPropagationStopped=function(){return!0===this.stop};var s=new t;function r(){var i=this,o=[],t=this.$options.events;t&&(n(t,function(t,r){n(e(t)?t:[t],function(t){var n,e=0;null!==(n=t)&&"object"==typeof n&&(e=t.priority,t=t.handler),o.push(s.on(r,function(t,n){if("string"==typeof t)return function(){return n[t].apply(n,arguments)};return t.bind(n)}(t,i),e))})}),this.$on("hook:beforeDestroy",function(){return o.forEach(function(t){return t()})}))}return s.install=function(t){this.installed||(t.events=this,t.prototype.$events=this,t.prototype.$trigger=this.trigger.bind(this),t.mixin(Number(t.version[0])<2?{init:r}:{beforeCreate:r}))},"undefined"!=typeof window&&window.Vue&&window.Vue.use(s),s});